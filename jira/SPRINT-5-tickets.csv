Summary,Issue Type,Description,Story Points,Priority,Labels
"Sprint 5: Explorar y Comparar",Epic,"Funcionalidades avanzadas para explorar tierlists de todos los usuarios, buscar entries con filtros, comparar valoraciones entre usuarios y ver estadÃ­sticas agregadas.",,High,epic
"EXPL-01: GET /api/tierlists - Listar todas las tierlists",Story,"## ðŸŽ¯ Objetivo
Implementar endpoint para explorar todas las tierlists de todos los usuarios.

---

## ðŸ“‹ EspecificaciÃ³n funcional

| MÃ©todo | Endpoint | Query Params | Response |
|--------|----------|--------------|----------|
| GET | /api/tierlists | page, size, sort, anio | 200 + Page<TierlistOverview> |

**TierlistOverview (Record):**
- id: Long
- userId: Long
- userName: String
- anio: Integer
- totalJuegos: Integer
- fechaCreacion: LocalDateTime

**Filtro opcional:**
- anio: filtrar por aÃ±o especÃ­fico

**OrdenaciÃ³n por defecto:** anio DESC, userName ASC

---

## âœ… Criterios de aceptaciÃ³n

- [ ] GET /api/tierlists devuelve todas las tierlists paginadas
- [ ] GET /api/tierlists?anio=2024 filtra por aÃ±o
- [ ] Incluye datos del usuario (nombre) sin N+1
- [ ] OrdenaciÃ³n por defecto: aÃ±o descendente

---

## ðŸ§ª Testing requerido

**Tests unitarios (ExploreServiceTest):**
- shouldReturnAllTierlistsPaginated
- shouldFilterByAnio

**Tests de controller (ExploreControllerTest):**
- shouldReturn200WithTierlists

---

## ðŸ’¡ Pistas

1. Crear ExploreService y ExploreController separados
2. Usar @EntityGraph o JOIN FETCH para cargar User
3. AÃ±adir mÃ©todo en TierlistRepository con filtro opcional

---

## ðŸ“– CÃ³digo de referencia

Ver: SPRINT-5-soluciones.md â†’ EXPL-01",3,High,"backend,api,sprint5"
"EXPL-02: GET /api/tierlists/entries - Buscar entries con filtros",Story,"## ðŸŽ¯ Objetivo
Implementar bÃºsqueda avanzada de entries usando Specifications (reutilizando el patrÃ³n de GAME-05).

---

## ðŸ“‹ EspecificaciÃ³n funcional

| MÃ©todo | Endpoint | Query Params | Response |
|--------|----------|--------------|----------|
| GET | /api/tierlists/entries | mÃºltiples filtros + paginaciÃ³n | 200 + Page<TierlistEntryWithUser> |

**Filtros disponibles (todos opcionales):**
- userId: filtrar por usuario
- anio: filtrar por aÃ±o de la tierlist
- gameNombre: bÃºsqueda parcial en nombre del juego
- gameCategoria: filtrar por categorÃ­a
- plataforma: filtrar por plataforma
- ratingMin: rating >= ratingMin
- ratingMax: rating <= ratingMax

**TierlistEntryWithUser (Record):**
- entryId: Long
- userId: Long
- userName: String
- anio: Integer
- gameNombre: String
- gamePlataforma: String
- gameCategoria: String
- rating: Integer
- tier: String

**Nota:** Los filtros usan los campos denormalizados de TierlistEntry.

---

## âœ… Criterios de aceptaciÃ³n

- [ ] Todos los filtros funcionan individualmente
- [ ] Los filtros se combinan con AND
- [ ] BÃºsqueda de nombre es parcial y case-insensitive
- [ ] Sin filtros devuelve todas las entries paginadas

---

## ðŸ§ª Testing requerido

**Tests unitarios (ExploreServiceTest):**
- shouldSearchEntriesByGameNombre
- shouldSearchEntriesByRatingRange
- shouldCombineFilters

**Tests de integraciÃ³n (ExploreSearchIT):**
- shouldFindEntriesMatchingFilters

---

## ðŸ”— Referencias

| Concepto | Documento |
|----------|-----------|
| Specifications | Ver GAME-05 como referencia |

---

## ðŸ’¡ Pistas

1. Crear TierlistEntrySpecification similar a GameSpecification
2. Los campos denormalizados permiten filtrar sin JOINs
3. Para userName necesitas JOIN con tierlist.user
4. TierlistEntryRepository ya extiende JpaSpecificationExecutor

---

## ðŸ“– CÃ³digo de referencia

Ver: SPRINT-5-soluciones.md â†’ EXPL-02",5,High,"backend,api,specification,sprint5"
"EXPL-03: GET /api/tierlists/compare - Comparar tierlists",Story,"## ðŸŽ¯ Objetivo
Implementar endpoint para comparar las tierlists de mÃºltiples usuarios para un aÃ±o dado.

---

## ðŸ“‹ EspecificaciÃ³n funcional

| MÃ©todo | Endpoint | Query Params | Response |
|--------|----------|--------------|----------|
| GET | /api/tierlists/compare | userIds, anio | 200 + TierlistComparison |

**ParÃ¡metros:**
- userIds: lista de IDs separados por coma (mÃ­nimo 2)
- anio: aÃ±o a comparar

**TierlistComparison (Record):**
- anio: Integer
- users: List<ComparisonUser>
- commonGames: List<CommonGame> (juegos que tienen TODOS)
- uniqueGames: Map<Long, List<UniqueGame>> (juegos Ãºnicos por userId)

**ComparisonUser (Record):**
- userId: Long
- userName: String
- totalJuegos: Integer

**CommonGame (Record):**
- gameNombre: String
- gamePlataforma: String
- ratings: Map<Long, Integer> (userId -> rating)
- averageRating: Double
- maxDifference: Integer (diferencia entre rating mÃ¡s alto y mÃ¡s bajo)

**UniqueGame (Record):**
- gameNombre: String
- gamePlataforma: String
- rating: Integer

---

## âœ… Criterios de aceptaciÃ³n

- [ ] GET /api/tierlists/compare?userIds=1,2&anio=2024 funciona
- [ ] commonGames contiene solo juegos que TODOS los usuarios tienen
- [ ] uniqueGames contiene juegos que solo tiene UN usuario
- [ ] GET con menos de 2 usuarios devuelve 400
- [ ] GET con usuario inexistente devuelve 404

---

## ðŸ§ª Testing requerido

**Tests unitarios (ExploreServiceTest):**
- shouldCompareAndFindCommonGames
- shouldCompareAndFindUniqueGames
- shouldCalculateMaxDifference
- shouldThrowWhenLessThanTwoUsers

---

## ðŸ”— Referencias

| Concepto | Documento |
|----------|-----------|
| Stream API | JAVA8-A-JAVA17.md - SecciÃ³n 9 |
| var | JAVA8-A-JAVA17.md - SecciÃ³n 6 |

---

## ðŸ’¡ Pistas

1. Cargar las tierlists de todos los usuarios para ese aÃ±o
2. Agrupar entries por gameId (o gameNombre+gamePlataforma)
3. Un juego es ""comÃºn"" si aparece en TODAS las tierlists
4. Un juego es ""Ãºnico"" si aparece en exactamente UNA tierlist
5. Usar Streams para agrupar y filtrar

---

## ðŸ“– CÃ³digo de referencia

Ver: SPRINT-5-soluciones.md â†’ EXPL-03",8,High,"backend,api,sprint5"
"EXPL-04: GET /api/tierlists/stats - EstadÃ­sticas agregadas",Story,"## ðŸŽ¯ Objetivo
Implementar endpoint para obtener estadÃ­sticas agregadas de todas las tierlists.

---

## ðŸ“‹ EspecificaciÃ³n funcional

| MÃ©todo | Endpoint | Query Params | Response |
|--------|----------|--------------|----------|
| GET | /api/tierlists/stats | anio (opcional) | 200 + TierlistStats |

**TierlistStats (Record):**
- totalEntries: Long
- averageRating: Double
- categoryStats: List<CategoryStats>
- topGames: List<TopGame>
- activeUsers: List<ActiveUser>

**CategoryStats (Record):**
- categoria: String
- totalJuegos: Integer
- averageRating: Double

**TopGame (Record):**
- gameNombre: String
- gamePlataforma: String
- averageRating: Double
- timesRated: Integer

**ActiveUser (Record):**
- userId: Long
- userName: String
- totalGamesRated: Integer

---

## âœ… Criterios de aceptaciÃ³n

- [ ] categoryStats muestra promedio por categorÃ­a ordenado por promedio DESC
- [ ] topGames muestra los 10 juegos mejor valorados (promedio)
- [ ] activeUsers muestra los 5 usuarios mÃ¡s activos
- [ ] GET /api/tierlists/stats?anio=2024 filtra por aÃ±o
- [ ] GET sin filtro devuelve estadÃ­sticas globales

---

## ðŸ§ª Testing requerido

**Tests unitarios (ExploreServiceTest):**
- shouldCalculateStatsByCategory
- shouldReturnTopGames
- shouldReturnActiveUsers
- shouldFilterStatsByAnio

---

## ðŸ”— Referencias

| Concepto | Documento |
|----------|-----------|
| Collectors.groupingBy | JAVA8-A-JAVA17.md - SecciÃ³n 9 |
| Collectors.averagingDouble | Stream API |

---

## ðŸ’¡ Pistas

1. Puedes usar JPQL con agregaciones: SELECT AVG(e.rating), e.gameCategoria FROM TierlistEntry e GROUP BY e.gameCategoria
2. O hacerlo en Java con Streams despuÃ©s de cargar los datos
3. Para topGames, agrupar por gameNombre+gamePlataforma y calcular promedio
4. Limitar resultados: .limit(10) en streams o LIMIT en JPQL

---

## ðŸ“– CÃ³digo de referencia

Ver: SPRINT-5-soluciones.md â†’ EXPL-04",5,Medium,"backend,api,jpql,sprint5"
"EXPL-05: VerificaciÃ³n final del proyecto",Story,"## ðŸŽ¯ Objetivo
Verificar que todas las funcionalidades estÃ¡n completas y funcionando correctamente.

---

## ðŸ“‹ Checklist de verificaciÃ³n

### CategorÃ­as
- [ ] GET /api/categories - Lista todas
- [ ] GET /api/categories/{id} - Detalle

### Usuarios
- [ ] GET /api/users - Lista todos
- [ ] GET /api/users/{id} - Detalle
- [ ] POST /api/users - Crear con validaciones
- [ ] PUT /api/users/{id} - Actualizar
- [ ] DELETE /api/users/{id} - Eliminar

### Juegos
- [ ] GET /api/games - Lista paginada
- [ ] GET /api/games/{id} - Detalle
- [ ] POST /api/games - Crear con FK a categorÃ­a
- [ ] PUT /api/games/{id} - Actualizar
- [ ] DELETE /api/games/{id} - Verificar si estÃ¡ en uso
- [ ] GET /api/games/search - Filtros funcionan

### Tierlists
- [ ] POST /api/users/{userId}/tierlists - Crear
- [ ] GET /api/users/{userId}/tierlists - Listar del usuario
- [ ] GET /api/users/{userId}/tierlists/{anio} - Detalle con entries
- [ ] POST .../entries - AÃ±adir juego
- [ ] PUT .../entries/{id} - Actualizar rating
- [ ] DELETE .../entries/{id} - Eliminar entry

### Explorar
- [ ] GET /api/tierlists - Todas las tierlists
- [ ] GET /api/tierlists/entries - BÃºsqueda con filtros
- [ ] GET /api/tierlists/compare - ComparaciÃ³n funciona
- [ ] GET /api/tierlists/stats - EstadÃ­sticas correctas

### TÃ©cnico
- [ ] Swagger UI muestra todos los endpoints
- [ ] Los errores devuelven JSON consistente
- [ ] Los tests pasan: mvn test
- [ ] La aplicaciÃ³n arranca sin errores

---

## ðŸ§ª Test de humo sugerido

1. Crear 2-3 usuarios
2. Crear varios juegos de diferentes categorÃ­as
3. Crear tierlists para los usuarios
4. AÃ±adir juegos a las tierlists con diferentes ratings
5. Probar la comparaciÃ³n entre usuarios
6. Verificar las estadÃ­sticas

---

## ðŸŽ‰ Â¡Proyecto completado!

Si todas las casillas estÃ¡n marcadas, has completado el proyecto Game Tierlist con:
- Java 17 (Records, Pattern Matching, Switch Expressions)
- Spring Boot 3
- JPA con relaciones, cascade y campos denormalizados
- PaginaciÃ³n y Specifications
- Testing unitario y de integraciÃ³n
- Manejo de errores centralizado",0,Low,"documentation,sprint5"
