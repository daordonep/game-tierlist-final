Summary,Issue Type,Description,Story Points,Priority,Labels
"Sprint 3: CatÃ¡logo de Juegos",Epic,"CRUD del catÃ¡logo de juegos compartido con relaciones @ManyToOne, paginaciÃ³n y bÃºsqueda avanzada usando JPA Specifications.",,High,epic
"GAME-01: Crear entidad Game",Story,"## ðŸŽ¯ Objetivo
Crear la entidad Game con relaciÃ³n @ManyToOne a Category.

---

## ðŸ“‹ EspecificaciÃ³n funcional

**Entidad Game:**
- Hereda de BaseEntity
- nombre: String (mÃ¡ximo 100 caracteres)
- plataforma: String (mÃ¡ximo 50 caracteres)
- descripcion: String (mÃ¡ximo 500 caracteres, opcional)
- anioLanzamiento: Integer
- category: Category (@ManyToOne)

**Constraints:**
- Unique compuesto: (nombre + plataforma) - El mismo juego puede existir en diferentes plataformas
- FK a category (no puede ser null)

**Repository:**
- Extender JpaRepository
- Extender JpaSpecificationExecutor<Game> (para filtros dinÃ¡micos)
- existsByNombreAndPlataforma(nombre, plataforma): boolean

---

## âœ… Criterios de aceptaciÃ³n

- [ ] Entidad Game creada con relaciÃ³n @ManyToOne LAZY a Category
- [ ] Constraint UNIQUE compuesto en (nombre, plataforma)
- [ ] GameRepository extiende JpaSpecificationExecutor
- [ ] Datos de prueba aÃ±adidos en data.sql (mÃ­nimo 10 juegos)

---

## ðŸ§ª Testing requerido

**Tests de repositorio (GameRepositoryTest):**
- shouldFindGameById
- shouldCheckExistsByNombreAndPlataforma

---

## ðŸ”— Referencias

| Concepto | Documento |
|----------|-----------|
| @ManyToOne LAZY | SPRINGBOOT2-A-SPRINGBOOT3.md - SecciÃ³n 3 |
| JpaSpecificationExecutor | Se usarÃ¡ en GAME-05 |

---

## ðŸ’¡ Pistas

1. @ManyToOne(fetch = FetchType.LAZY) evita cargar la categorÃ­a si no se necesita
2. @JoinColumn(name = ""category_id"") define la FK
3. @UniqueConstraint en @Table para el unique compuesto
4. En data.sql, referencia las categorÃ­as por su ID

---

## ðŸ“– CÃ³digo de referencia

Ver: SPRINT-3-soluciones.md â†’ GAME-01",3,High,"backend,entity,sprint3"
"GAME-02: GET /api/games - Listar juegos con paginaciÃ³n",Story,"## ðŸŽ¯ Objetivo
Implementar endpoint para listar juegos con paginaciÃ³n y ordenaciÃ³n.

---

## ðŸ“‹ EspecificaciÃ³n funcional

| MÃ©todo | Endpoint | Query Params | Response |
|--------|----------|--------------|----------|
| GET | /api/games | page, size, sort | 200 + Page<GameResponse> |

**ParÃ¡metros de paginaciÃ³n (proporcionados por Spring):**
- page: nÃºmero de pÃ¡gina (0-indexed, default 0)
- size: elementos por pÃ¡gina (default 20)
- sort: campo,direcciÃ³n (ej: nombre,asc)

**GameResponse (Record):**
- id: Long
- nombre: String
- plataforma: String
- descripcion: String
- anioLanzamiento: Integer
- categoriaId: Long
- categoriaNombre: String
- fechaCreacion: LocalDateTime

**Clases a crear:**
- GameResponse (dto/response)
- GameMapper (mapper)
- GameService (service)
- GameController (controller)

---

## âœ… Criterios de aceptaciÃ³n

- [ ] GET /api/games devuelve Page con juegos
- [ ] GET /api/games?page=0&size=5 devuelve 5 elementos
- [ ] GET /api/games?sort=nombre,asc ordena alfabÃ©ticamente
- [ ] La respuesta incluye metadata de paginaciÃ³n (totalElements, totalPages, etc.)
- [ ] El GameResponse incluye nombre de la categorÃ­a (no solo el ID)

---

## ðŸ§ª Testing requerido

**Tests unitarios (GameServiceTest):**
- shouldReturnPageOfGames
- shouldReturnEmptyPageWhenNoGames

**Tests de controller (GameControllerTest):**
- shouldReturn200WithPageOfGames
- shouldRespectPaginationParameters

---

## ðŸ”— Referencias

| Concepto | Documento |
|----------|-----------|
| Records | JAVA8-A-JAVA17.md - SecciÃ³n 1 |
| Stream.toList() | JAVA8-A-JAVA17.md - SecciÃ³n 7 |

---

## ðŸ’¡ Pistas

1. Pageable como parÃ¡metro del mÃ©todo del repositorio
2. Page<T> tiene mÃ©todos: getContent(), getTotalElements(), getTotalPages()
3. El mapper accede a game.getCategory().getNombre() para el nombre de categorÃ­a
4. @PageableDefault(size = 20, sort = ""nombre"") para valores por defecto

---

## ðŸ“– CÃ³digo de referencia

Ver: SPRINT-3-soluciones.md â†’ GAME-02",3,High,"backend,api,sprint3"
"GAME-03: POST /api/games - Crear juego",Story,"## ðŸŽ¯ Objetivo
Implementar endpoint para crear juegos con validaciÃ³n de categorÃ­a existente y unicidad.

---

## ðŸ“‹ EspecificaciÃ³n funcional

| MÃ©todo | Endpoint | Request Body | Response |
|--------|----------|--------------|----------|
| POST | /api/games | CreateGameRequest | 201 + GameResponse |

**CreateGameRequest (Record con validaciones):**
- nombre: String (@NotBlank, @Size max=100)
- plataforma: String (@NotBlank, @Size max=50)
- descripcion: String (@Size max=500, opcional)
- anioLanzamiento: Integer (@NotNull, @Min=1970, @Max=2030)
- categoriaId: Long (@NotNull)

**Reglas de negocio:**
- La categorÃ­a debe existir
- La combinaciÃ³n nombre+plataforma debe ser Ãºnica
- Se aplica trim() a nombre y plataforma

**Nueva excepciÃ³n necesaria:**
- RelatedEntityNotFoundException: Para cuando la FK no existe (categorÃ­a)

---

## âœ… Criterios de aceptaciÃ³n

| Caso | Input | Output esperado |
|------|-------|-----------------|
| Juego vÃ¡lido | Request completo vÃ¡lido | 201 + GameResponse |
| CategorÃ­a no existe | categoriaId: 999 | 404 + NOT_FOUND |
| Duplicado | nombre+plataforma ya existe | 409 + DUPLICATE_ENTITY |
| ValidaciÃ³n falla | nombre vacÃ­o | 400 + VALIDATION_ERROR |

---

## ðŸ§ª Testing requerido

**Tests unitarios (GameServiceTest):**
- shouldCreateGame_WhenValid
- shouldThrowNotFound_WhenCategoryDoesNotExist
- shouldThrowDuplicate_WhenGameAlreadyExists

**Tests de controller (GameControllerTest):**
- shouldReturn201_WhenGameCreated
- shouldReturn404_WhenCategoryNotFound
- shouldReturn409_WhenDuplicateGame

---

## ðŸ”— Referencias

| Concepto | Documento |
|----------|-----------|
| Records con validaciones | JAVA8-A-JAVA17.md - SecciÃ³n 1 |
| jakarta.validation | SPRINGBOOT2-A-SPRINGBOOT3.md - SecciÃ³n 4 |

---

## ðŸ’¡ Pistas

1. Primero verificar que la categorÃ­a existe con categoryRepository.findById()
2. Luego verificar unicidad con existsByNombreAndPlataforma()
3. RelatedEntityNotFoundException puede extender RuntimeException
4. AÃ±adir handler en GlobalExceptionHandler que devuelva 404

---

## ðŸ“– CÃ³digo de referencia

Ver: SPRINT-3-soluciones.md â†’ GAME-03",5,High,"backend,api,sprint3"
"GAME-04: GET/PUT/DELETE /api/games/{id}",Story,"## ðŸŽ¯ Objetivo
Completar el CRUD de juegos con operaciones por ID.

---

## ðŸ“‹ EspecificaciÃ³n funcional

| MÃ©todo | Endpoint | Request Body | Response |
|--------|----------|--------------|----------|
| GET | /api/games/{id} | - | 200 + GameResponse |
| PUT | /api/games/{id} | UpdateGameRequest | 200 + GameResponse |
| DELETE | /api/games/{id} | - | 204 No Content |

**UpdateGameRequest (Record):**
- nombre: String (@NotBlank, @Size max=100)
- plataforma: String (@NotBlank, @Size max=50)
- descripcion: String (@Size max=500, opcional)
- anioLanzamiento: Integer (@NotNull, @Min=1970, @Max=2030)
- categoriaId: Long (@NotNull)

**Reglas para PUT:**
- El juego debe existir
- La nueva categorÃ­a debe existir
- La nueva combinaciÃ³n nombre+plataforma no puede estar en uso por OTRO juego

---

## âœ… Criterios de aceptaciÃ³n

**GET:**
- [ ] GET /api/games/1 devuelve el juego
- [ ] GET /api/games/999 devuelve 404

**PUT:**
- [ ] PUT actualiza todos los campos incluyendo categorÃ­a
- [ ] PUT con categorÃ­a inexistente devuelve 404
- [ ] PUT con nombre+plataforma duplicado (de otro) devuelve 409

**DELETE:**
- [ ] DELETE /api/games/1 devuelve 204
- [ ] DELETE /api/games/999 devuelve 404

---

## ðŸ§ª Testing requerido

**Tests unitarios (GameServiceTest):**
- shouldReturnGame_WhenIdExists
- shouldUpdateGame_WhenValid
- shouldDeleteGame_WhenExists
- shouldThrowNotFound_WhenGameDoesNotExist

**Tests de controller (GameControllerTest):**
- shouldReturn200_WhenGameFound
- shouldReturn200_WhenGameUpdated
- shouldReturn204_WhenGameDeleted
- shouldReturn404_WhenGameNotFound

---

## ðŸ’¡ Pistas

1. Para verificar duplicado en update: existsByNombreAndPlataformaAndIdNot(nombre, plataforma, id)
2. AÃ±adir este mÃ©todo al GameRepository
3. En el mapper, para update necesitas recibir la Category ya cargada

---

## ðŸ“– CÃ³digo de referencia

Ver: SPRINT-3-soluciones.md â†’ GAME-04",3,High,"backend,api,sprint3"
"GAME-05: GET /api/games/search - BÃºsqueda con filtros",Story,"## ðŸŽ¯ Objetivo
Implementar bÃºsqueda avanzada de juegos usando JPA Specifications para filtros dinÃ¡micos.

---

## ðŸ“‹ EspecificaciÃ³n funcional

| MÃ©todo | Endpoint | Query Params | Response |
|--------|----------|--------------|----------|
| GET | /api/games/search | nombre, plataforma, categoriaId, anioMin, anioMax + paginaciÃ³n | 200 + Page<GameResponse> |

**Filtros disponibles (todos opcionales):**
- nombre: bÃºsqueda parcial, case-insensitive (LIKE %nombre%)
- plataforma: bÃºsqueda exacta
- categoriaId: filtrar por categorÃ­a
- anioMin: aÃ±o de lanzamiento >= anioMin
- anioMax: aÃ±o de lanzamiento <= anioMax

**Comportamiento:**
- Los filtros se combinan con AND
- Si no hay filtros, devuelve todos los juegos (paginados)
- Soporta paginaciÃ³n y ordenaciÃ³n

**Clase a crear:**
- GameSpecification (specification/)

---

## âœ… Criterios de aceptaciÃ³n

- [ ] GET /api/games/search?nombre=zelda encuentra juegos con ""zelda"" en el nombre
- [ ] GET /api/games/search?plataforma=PC filtra por plataforma exacta
- [ ] GET /api/games/search?categoriaId=1 filtra por categorÃ­a
- [ ] GET /api/games/search?anioMin=2020&anioMax=2023 filtra por rango de aÃ±os
- [ ] GET /api/games/search?nombre=mario&plataforma=Nintendo combina filtros
- [ ] GET /api/games/search sin parÃ¡metros devuelve todos paginados

---

## ðŸ§ª Testing requerido

**Tests unitarios (GameServiceTest):**
- shouldSearchByNombrePartial
- shouldSearchByPlataformaExact
- shouldSearchByCategoriaId
- shouldSearchByAnioRange
- shouldCombineMultipleFilters
- shouldReturnAllWhenNoFilters

**Tests de integraciÃ³n (GameSearchIT):**
- shouldFindGamesMatchingFilters

---

## ðŸ”— Referencias

| Concepto | Documento |
|----------|-----------|
| Criteria API | Concepto JPA estÃ¡ndar |
| var | JAVA8-A-JAVA17.md - SecciÃ³n 6 |

---

## ðŸ’¡ Pistas

1. Specification<Game> es una interfaz funcional con mÃ©todo toPredicate()
2. Usa CriteriaBuilder para construir condiciones (like, equal, greaterThanOrEqualTo)
3. cb.lower() para bÃºsqueda case-insensitive
4. Combina predicados con cb.and()
5. El controller recibe los filtros como @RequestParam(required = false)

---

## ðŸ“– CÃ³digo de referencia

Ver: SPRINT-3-soluciones.md â†’ GAME-05",5,High,"backend,api,specification,sprint3"
